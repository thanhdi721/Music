{"ast":null,"code":"function getError(option, xhr) {\n  var msg = \"cannot \".concat(option.method, \" \").concat(option.action, \" \").concat(xhr.status, \"'\");\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = option.method;\n  err.url = option.action;\n  return err;\n}\n\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n\n  if (!text) {\n    return text;\n  }\n\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n}\n\nexport default function upload(option) {\n  // eslint-disable-next-line no-undef\n  var xhr = new XMLHttpRequest();\n\n  if (option.onProgress && xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n\n      option.onProgress(e);\n    };\n  } // eslint-disable-next-line no-undef\n\n\n  var formData = new FormData();\n\n  if (option.data) {\n    Object.keys(option.data).forEach(function (key) {\n      var value = option.data[key]; // support key-value array data\n\n      if (Array.isArray(value)) {\n        value.forEach(function (item) {\n          // { list: [ 11, 22 ] }\n          // formData.append('list[]', 11);\n          formData.append(\"\".concat(key, \"[]\"), item);\n        });\n        return;\n      }\n\n      formData.append(key, value);\n    });\n  } // eslint-disable-next-line no-undef\n\n\n  if (option.file instanceof Blob) {\n    formData.append(option.filename, option.file, option.file.name);\n  } else {\n    formData.append(option.filename, option.file);\n  }\n\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n\n  xhr.onload = function onload() {\n    // allow success when 2xx status\n    // see https://github.com/react-component/upload/issues/34\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(option, xhr), getBody(xhr));\n    }\n\n    return option.onSuccess(getBody(xhr), xhr);\n  };\n\n  xhr.open(option.method, option.action, true); // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n\n  var headers = option.headers || {}; // when set headers['X-Requested-With'] = null , can close default XHR header\n  // see https://github.com/react-component/upload/issues/33\n\n  if (headers['X-Requested-With'] !== null) {\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n  }\n\n  Object.keys(headers).forEach(function (h) {\n    if (headers[h] !== null) {\n      xhr.setRequestHeader(h, headers[h]);\n    }\n  });\n  xhr.send(formData);\n  return {\n    abort: function abort() {\n      xhr.abort();\n    }\n  };\n}","map":{"version":3,"sources":["D:/WED/SpotifyProject-master/node_modules/rc-upload/es/request.js"],"names":["getError","option","xhr","msg","concat","method","action","status","err","Error","url","getBody","text","responseText","response","JSON","parse","e","upload","XMLHttpRequest","onProgress","onprogress","progress","total","percent","loaded","formData","FormData","data","Object","keys","forEach","key","value","Array","isArray","item","append","file","Blob","filename","name","onerror","error","onError","onload","onSuccess","open","withCredentials","headers","setRequestHeader","h","send","abort"],"mappings":"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","sourcesContent":["function getError(option, xhr) {\n  var msg = \"cannot \".concat(option.method, \" \").concat(option.action, \" \").concat(xhr.status, \"'\");\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = option.method;\n  err.url = option.action;\n  return err;\n}\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n  if (!text) {\n    return text;\n  }\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n}\nexport default function upload(option) {\n  // eslint-disable-next-line no-undef\n  var xhr = new XMLHttpRequest();\n  if (option.onProgress && xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n      option.onProgress(e);\n    };\n  }\n\n  // eslint-disable-next-line no-undef\n  var formData = new FormData();\n  if (option.data) {\n    Object.keys(option.data).forEach(function (key) {\n      var value = option.data[key];\n      // support key-value array data\n      if (Array.isArray(value)) {\n        value.forEach(function (item) {\n          // { list: [ 11, 22 ] }\n          // formData.append('list[]', 11);\n          formData.append(\"\".concat(key, \"[]\"), item);\n        });\n        return;\n      }\n      formData.append(key, value);\n    });\n  }\n\n  // eslint-disable-next-line no-undef\n  if (option.file instanceof Blob) {\n    formData.append(option.filename, option.file, option.file.name);\n  } else {\n    formData.append(option.filename, option.file);\n  }\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n  xhr.onload = function onload() {\n    // allow success when 2xx status\n    // see https://github.com/react-component/upload/issues/34\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(option, xhr), getBody(xhr));\n    }\n    return option.onSuccess(getBody(xhr), xhr);\n  };\n  xhr.open(option.method, option.action, true);\n\n  // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n  var headers = option.headers || {};\n\n  // when set headers['X-Requested-With'] = null , can close default XHR header\n  // see https://github.com/react-component/upload/issues/33\n  if (headers['X-Requested-With'] !== null) {\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n  }\n  Object.keys(headers).forEach(function (h) {\n    if (headers[h] !== null) {\n      xhr.setRequestHeader(h, headers[h]);\n    }\n  });\n  xhr.send(formData);\n  return {\n    abort: function abort() {\n      xhr.abort();\n    }\n  };\n}"]},"metadata":{},"sourceType":"module"}