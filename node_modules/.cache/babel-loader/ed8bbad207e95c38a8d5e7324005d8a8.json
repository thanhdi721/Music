{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { useEffect, useRef, useState } from 'react';\nimport { isImageValid } from \"../util\";\nexport default function useStatus(_ref) {\n  var src = _ref.src,\n      isCustomPlaceholder = _ref.isCustomPlaceholder,\n      fallback = _ref.fallback;\n\n  var _useState = useState(isCustomPlaceholder ? 'loading' : 'normal'),\n      _useState2 = _slicedToArray(_useState, 2),\n      status = _useState2[0],\n      setStatus = _useState2[1];\n\n  var isLoaded = useRef(false);\n  var isError = status === 'error'; // https://github.com/react-component/image/pull/187\n\n  useEffect(function () {\n    var isCurrentSrc = true;\n    isImageValid(src).then(function (isValid) {\n      // https://github.com/ant-design/ant-design/issues/44948\n      // If src changes, the previous setStatus should not be triggered\n      if (!isValid && isCurrentSrc) {\n        setStatus('error');\n      }\n    });\n    return function () {\n      isCurrentSrc = false;\n    };\n  }, [src]);\n  useEffect(function () {\n    if (isCustomPlaceholder && !isLoaded.current) {\n      setStatus('loading');\n    } else if (isError) {\n      setStatus('normal');\n    }\n  }, [src]);\n\n  var onLoad = function onLoad() {\n    setStatus('normal');\n  };\n\n  var getImgRef = function getImgRef(img) {\n    isLoaded.current = false;\n\n    if (status === 'loading' && img !== null && img !== void 0 && img.complete && (img.naturalWidth || img.naturalHeight)) {\n      isLoaded.current = true;\n      onLoad();\n    }\n  };\n\n  var srcAndOnload = isError && fallback ? {\n    src: fallback\n  } : {\n    onLoad: onLoad,\n    src: src\n  };\n  return [getImgRef, srcAndOnload, status];\n}","map":{"version":3,"sources":["C:/Users/ASUS/Documents/Music/node_modules/rc-image/es/hooks/useStatus.js"],"names":["_slicedToArray","useEffect","useRef","useState","isImageValid","useStatus","_ref","src","isCustomPlaceholder","fallback","_useState","_useState2","status","setStatus","isLoaded","isError","isCurrentSrc","then","isValid","current","onLoad","getImgRef","img","complete","naturalWidth","naturalHeight","srcAndOnload"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,0CAA3B;AACA,SAASC,SAAT,EAAoBC,MAApB,EAA4BC,QAA5B,QAA4C,OAA5C;AACA,SAASC,YAAT,QAA6B,SAA7B;AACA,eAAe,SAASC,SAAT,CAAmBC,IAAnB,EAAyB;AACtC,MAAIC,GAAG,GAAGD,IAAI,CAACC,GAAf;AAAA,MACEC,mBAAmB,GAAGF,IAAI,CAACE,mBAD7B;AAAA,MAEEC,QAAQ,GAAGH,IAAI,CAACG,QAFlB;;AAGA,MAAIC,SAAS,GAAGP,QAAQ,CAACK,mBAAmB,GAAG,SAAH,GAAe,QAAnC,CAAxB;AAAA,MACEG,UAAU,GAAGX,cAAc,CAACU,SAAD,EAAY,CAAZ,CAD7B;AAAA,MAEEE,MAAM,GAAGD,UAAU,CAAC,CAAD,CAFrB;AAAA,MAGEE,SAAS,GAAGF,UAAU,CAAC,CAAD,CAHxB;;AAIA,MAAIG,QAAQ,GAAGZ,MAAM,CAAC,KAAD,CAArB;AACA,MAAIa,OAAO,GAAGH,MAAM,KAAK,OAAzB,CATsC,CAWtC;;AACAX,EAAAA,SAAS,CAAC,YAAY;AACpB,QAAIe,YAAY,GAAG,IAAnB;AACAZ,IAAAA,YAAY,CAACG,GAAD,CAAZ,CAAkBU,IAAlB,CAAuB,UAAUC,OAAV,EAAmB;AACxC;AACA;AACA,UAAI,CAACA,OAAD,IAAYF,YAAhB,EAA8B;AAC5BH,QAAAA,SAAS,CAAC,OAAD,CAAT;AACD;AACF,KAND;AAOA,WAAO,YAAY;AACjBG,MAAAA,YAAY,GAAG,KAAf;AACD,KAFD;AAGD,GAZQ,EAYN,CAACT,GAAD,CAZM,CAAT;AAaAN,EAAAA,SAAS,CAAC,YAAY;AACpB,QAAIO,mBAAmB,IAAI,CAACM,QAAQ,CAACK,OAArC,EAA8C;AAC5CN,MAAAA,SAAS,CAAC,SAAD,CAAT;AACD,KAFD,MAEO,IAAIE,OAAJ,EAAa;AAClBF,MAAAA,SAAS,CAAC,QAAD,CAAT;AACD;AACF,GANQ,EAMN,CAACN,GAAD,CANM,CAAT;;AAOA,MAAIa,MAAM,GAAG,SAASA,MAAT,GAAkB;AAC7BP,IAAAA,SAAS,CAAC,QAAD,CAAT;AACD,GAFD;;AAGA,MAAIQ,SAAS,GAAG,SAASA,SAAT,CAAmBC,GAAnB,EAAwB;AACtCR,IAAAA,QAAQ,CAACK,OAAT,GAAmB,KAAnB;;AACA,QAAIP,MAAM,KAAK,SAAX,IAAwBU,GAAG,KAAK,IAAhC,IAAwCA,GAAG,KAAK,KAAK,CAArD,IAA0DA,GAAG,CAACC,QAA9D,KAA2ED,GAAG,CAACE,YAAJ,IAAoBF,GAAG,CAACG,aAAnG,CAAJ,EAAuH;AACrHX,MAAAA,QAAQ,CAACK,OAAT,GAAmB,IAAnB;AACAC,MAAAA,MAAM;AACP;AACF,GAND;;AAOA,MAAIM,YAAY,GAAGX,OAAO,IAAIN,QAAX,GAAsB;AACvCF,IAAAA,GAAG,EAAEE;AADkC,GAAtB,GAEf;AACFW,IAAAA,MAAM,EAAEA,MADN;AAEFb,IAAAA,GAAG,EAAEA;AAFH,GAFJ;AAMA,SAAO,CAACc,SAAD,EAAYK,YAAZ,EAA0Bd,MAA1B,CAAP;AACD","sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { useEffect, useRef, useState } from 'react';\nimport { isImageValid } from \"../util\";\nexport default function useStatus(_ref) {\n  var src = _ref.src,\n    isCustomPlaceholder = _ref.isCustomPlaceholder,\n    fallback = _ref.fallback;\n  var _useState = useState(isCustomPlaceholder ? 'loading' : 'normal'),\n    _useState2 = _slicedToArray(_useState, 2),\n    status = _useState2[0],\n    setStatus = _useState2[1];\n  var isLoaded = useRef(false);\n  var isError = status === 'error';\n\n  // https://github.com/react-component/image/pull/187\n  useEffect(function () {\n    var isCurrentSrc = true;\n    isImageValid(src).then(function (isValid) {\n      // https://github.com/ant-design/ant-design/issues/44948\n      // If src changes, the previous setStatus should not be triggered\n      if (!isValid && isCurrentSrc) {\n        setStatus('error');\n      }\n    });\n    return function () {\n      isCurrentSrc = false;\n    };\n  }, [src]);\n  useEffect(function () {\n    if (isCustomPlaceholder && !isLoaded.current) {\n      setStatus('loading');\n    } else if (isError) {\n      setStatus('normal');\n    }\n  }, [src]);\n  var onLoad = function onLoad() {\n    setStatus('normal');\n  };\n  var getImgRef = function getImgRef(img) {\n    isLoaded.current = false;\n    if (status === 'loading' && img !== null && img !== void 0 && img.complete && (img.naturalWidth || img.naturalHeight)) {\n      isLoaded.current = true;\n      onLoad();\n    }\n  };\n  var srcAndOnload = isError && fallback ? {\n    src: fallback\n  } : {\n    onLoad: onLoad,\n    src: src\n  };\n  return [getImgRef, srcAndOnload, status];\n}"]},"metadata":{},"sourceType":"module"}