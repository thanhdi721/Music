{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport useEvent from \"rc-util/es/hooks/useEvent\";\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport isEqual from \"rc-util/es/isEqual\";\nimport * as React from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createContext(defaultValue) {\n  var Context = /*#__PURE__*/React.createContext(undefined);\n\n  var Provider = function Provider(_ref) {\n    var value = _ref.value,\n        children = _ref.children;\n    var valueRef = React.useRef(value);\n    valueRef.current = value;\n\n    var _React$useState = React.useState(function () {\n      return {\n        getValue: function getValue() {\n          return valueRef.current;\n        },\n        listeners: new Set()\n      };\n    }),\n        _React$useState2 = _slicedToArray(_React$useState, 1),\n        context = _React$useState2[0];\n\n    useLayoutEffect(function () {\n      unstable_batchedUpdates(function () {\n        context.listeners.forEach(function (listener) {\n          listener(value);\n        });\n      });\n    }, [value]);\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: context\n    }, children);\n  };\n\n  return {\n    Context: Context,\n    Provider: Provider,\n    defaultValue: defaultValue\n  };\n}\n/** e.g. useSelect(userContext) => user */\n\n/** e.g. useSelect(userContext, user => user.name) => user.name */\n\n/** e.g. useSelect(userContext, ['name', 'age']) => user { name, age } */\n\n/** e.g. useSelect(userContext, 'name') => user.name */\n\nexport function useContext(holder, selector) {\n  var eventSelector = useEvent(typeof selector === 'function' ? selector : function (ctx) {\n    if (selector === undefined) {\n      return ctx;\n    }\n\n    if (!Array.isArray(selector)) {\n      return ctx[selector];\n    }\n\n    var obj = {};\n    selector.forEach(function (key) {\n      obj[key] = ctx[key];\n    });\n    return obj;\n  });\n  var context = React.useContext(holder === null || holder === void 0 ? void 0 : holder.Context);\n\n  var _ref2 = context || {},\n      listeners = _ref2.listeners,\n      getValue = _ref2.getValue;\n\n  var valueRef = React.useRef();\n  valueRef.current = eventSelector(context ? getValue() : holder === null || holder === void 0 ? void 0 : holder.defaultValue);\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      forceUpdate = _React$useState4[1];\n\n  useLayoutEffect(function () {\n    if (!context) {\n      return;\n    }\n\n    function trigger(nextValue) {\n      var nextSelectorValue = eventSelector(nextValue);\n\n      if (!isEqual(valueRef.current, nextSelectorValue, true)) {\n        forceUpdate({});\n      }\n    }\n\n    listeners.add(trigger);\n    return function () {\n      listeners.delete(trigger);\n    };\n  }, [context]);\n  return valueRef.current;\n}","map":{"version":3,"sources":["C:/Users/ASUS/Documents/Music/node_modules/@rc-component/context/es/context.js"],"names":["_slicedToArray","useEvent","useLayoutEffect","isEqual","React","unstable_batchedUpdates","createContext","defaultValue","Context","undefined","Provider","_ref","value","children","valueRef","useRef","current","_React$useState","useState","getValue","listeners","Set","_React$useState2","context","forEach","listener","createElement","useContext","holder","selector","eventSelector","ctx","Array","isArray","obj","key","_ref2","_React$useState3","_React$useState4","forceUpdate","trigger","nextValue","nextSelectorValue","add","delete"],"mappings":"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","sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport useEvent from \"rc-util/es/hooks/useEvent\";\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport isEqual from \"rc-util/es/isEqual\";\nimport * as React from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createContext(defaultValue) {\n  var Context = /*#__PURE__*/React.createContext(undefined);\n  var Provider = function Provider(_ref) {\n    var value = _ref.value,\n      children = _ref.children;\n    var valueRef = React.useRef(value);\n    valueRef.current = value;\n    var _React$useState = React.useState(function () {\n        return {\n          getValue: function getValue() {\n            return valueRef.current;\n          },\n          listeners: new Set()\n        };\n      }),\n      _React$useState2 = _slicedToArray(_React$useState, 1),\n      context = _React$useState2[0];\n    useLayoutEffect(function () {\n      unstable_batchedUpdates(function () {\n        context.listeners.forEach(function (listener) {\n          listener(value);\n        });\n      });\n    }, [value]);\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: context\n    }, children);\n  };\n  return {\n    Context: Context,\n    Provider: Provider,\n    defaultValue: defaultValue\n  };\n}\n\n/** e.g. useSelect(userContext) => user */\n\n/** e.g. useSelect(userContext, user => user.name) => user.name */\n\n/** e.g. useSelect(userContext, ['name', 'age']) => user { name, age } */\n\n/** e.g. useSelect(userContext, 'name') => user.name */\n\nexport function useContext(holder, selector) {\n  var eventSelector = useEvent(typeof selector === 'function' ? selector : function (ctx) {\n    if (selector === undefined) {\n      return ctx;\n    }\n    if (!Array.isArray(selector)) {\n      return ctx[selector];\n    }\n    var obj = {};\n    selector.forEach(function (key) {\n      obj[key] = ctx[key];\n    });\n    return obj;\n  });\n  var context = React.useContext(holder === null || holder === void 0 ? void 0 : holder.Context);\n  var _ref2 = context || {},\n    listeners = _ref2.listeners,\n    getValue = _ref2.getValue;\n  var valueRef = React.useRef();\n  valueRef.current = eventSelector(context ? getValue() : holder === null || holder === void 0 ? void 0 : holder.defaultValue);\n  var _React$useState3 = React.useState({}),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    forceUpdate = _React$useState4[1];\n  useLayoutEffect(function () {\n    if (!context) {\n      return;\n    }\n    function trigger(nextValue) {\n      var nextSelectorValue = eventSelector(nextValue);\n      if (!isEqual(valueRef.current, nextSelectorValue, true)) {\n        forceUpdate({});\n      }\n    }\n    listeners.add(trigger);\n    return function () {\n      listeners.delete(trigger);\n    };\n  }, [context]);\n  return valueRef.current;\n}"]},"metadata":{},"sourceType":"module"}